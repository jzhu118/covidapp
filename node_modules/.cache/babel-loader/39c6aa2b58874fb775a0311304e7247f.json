{"ast":null,"code":"import * as d3 from 'd3';\nconst parseTime = d3.timeParse('%d/%m/%y');\nlet chart = {},\n    x,\n    y0,\n    y1,\n    line0,\n    line1,\n    width,\n    height,\n    g;\n\nchart.create = (el, props, state) => {\n  const margin = {\n    top: 20,\n    right: 80,\n    bottom: 30,\n    left: 80\n  };\n  let svg = d3.select(el).append('svg').attr('class', 'chart').attr('width', props.width).attr('height', props.height);\n  width = svg.attr('width') - margin.left - margin.right;\n  height = svg.attr('height') - margin.top - margin.bottom;\n  g = svg.append('g').attr('transform', 'translate(' + margin.left + ',' + margin.top + ')');\n  x = d3.scaleTime().rangeRound([0, width]);\n  y0 = d3.scaleLinear().rangeRound([height, 0]);\n  y1 = d3.scaleLinear().rangeRound([height, 0]);\n  line0 = d3.line().x(function (d) {\n    return x(d.Date);\n  }).y(function (d) {\n    return y0(d.Weekly_ICSA);\n  });\n  line1 = d3.line().x(function (d) {\n    return x(d.Date);\n  }).y(function (d) {\n    return y1(d.Weekly_New_Cases);\n  });\n  chart.update(state);\n};\n\nchart.update = state => {\n  let svg = d3.select('svg');\n  chart.draw(svg, state.data, state.title);\n};\n\nchart.draw = function (svg, data, title) {\n  this.cleanUp();\n  data.forEach(function (d) {\n    d.Date = parseTime(d.Date);\n    d.Weekly_ICSA = +d.Weekly_ICSA;\n    d.Weekly_New_Cases = +d.Weekly_New_Cases;\n    return d;\n  });\n  x.domain(d3.extent(data, function (d) {\n    return d.Date;\n  }));\n  y0.domain([0, d3.max(data, function (d) {\n    return d.Weekly_ICSA;\n  })]);\n  y1.domain([0, d3.max(data, function (d) {\n    return d.Weekly_New_Cases;\n  })]); // Add axis:\n\n  g.append('g').attr('class', 'x-axis').attr('transform', 'translate(0,' + height + ')').call(d3.axisBottom(x).ticks(d3.timeWeek.every(2)));\n  g.append('g').attr('class', 'y-axis').style(\"fill\", \"steelblue\").attr('fill', 'steelblue').call(d3.axisLeft(y0)); // .append('text')\n  // .attr('fill', 'steelblue')\n  // .attr('transform', 'rotate(-90)')\n  // .attr('y', 6)\n  // .attr('dy', '0.71em')\n  // .attr('text-anchor', 'end')\n  // .text('Weekly ICSA');\n\n  g.append('g').attr('class', 'y-axis').style(\"fill\", \"red\").attr(\"transform\", \"translate(\" + width + \" ,0)\").attr('fill', 'red').call(d3.axisRight(y1)); // .append('text')\n  // .attr('fill', 'red')\n  // .attr(\"transform\", \"translate(\" + width + \" ,0)\")\n  // .attr('y', 6)\n  // .attr('dy', '0.71em')\n  // .attr('text-anchor', 'end')\n  // .text('Weekly New Case');\n  // Add path:\n\n  var path0 = g.append('path').attr('class', function (d) {\n    return \"icsa\";\n  }).datum(data).attr('fill', 'none').attr('stroke', 'steelblue').attr('stroke-linejoin', 'round').attr('stroke-linecap', 'round').attr('stroke-width', 1.5).attr('d', line0);\n  var path1 = g.append('path').attr('class', function (d) {\n    return \"newcase\";\n  }).datum(data).attr('fill', 'none').attr('stroke', 'red').attr('stroke-linejoin', 'round').attr('stroke-linecap', 'round').attr('stroke-width', 1.5).attr('d', line1); // Add tooltip\n\n  var tooltip = d3.select(\"body\").append(\"div\").style(\"opacity\", 0).attr(\"class\", \"tooltip\").style(\"background-color\", \"grey\").style(\"border-radius\", \"5px\").style(\"padding\", \"10px\").style(\"color\", \"white\");\n\n  var showICSATooltip = function (d) {\n    tooltip.transition().duration(200);\n    tooltip.style(\"opacity\", 1).html(\"Weekly ICSA: \" + d.Weekly_ICSA).style(\"left\", d3.event.pageX + \"px\").style(\"top\", d3.event.pageY - 28 + \"px\");\n  };\n\n  var showNewCaseTooltip = function (d) {\n    tooltip.transition().duration(200);\n    tooltip.style(\"opacity\", 1).html(\"Weekly New Cases: \" + d.Weekly_New_Cases).style(\"left\", d3.event.pageX + \"px\").style(\"top\", d3.event.pageY - 28 + \"px\");\n  };\n\n  var moveTooltip = function (d) {\n    tooltip.style(\"left\", d3.event.pageX + \"px\").style(\"top\", d3.event.pageY - 28 + \"px\");\n  };\n\n  var hideTooltip = function (d) {\n    tooltip.transition().duration(200).style(\"opacity\", 0);\n  }; // Add circle:\n\n\n  g.selectAll(\"myPoints\").data(data).enter().append('circle').attr('class', function (d) {\n    return \"icsa\";\n  }).attr(\"cx\", function (d) {\n    return x(d.Date);\n  }).attr(\"cy\", function (d) {\n    return y0(d.Weekly_ICSA);\n  }).attr(\"r\", 5).attr(\"stroke\", \"white\").style(\"fill\", \"steelblue\").on(\"mouseover\", showICSATooltip).on(\"mousemove\", moveTooltip).on(\"mouseleave\", hideTooltip);\n  g.selectAll(\"myPoints\").data(data).enter().append('circle').attr('class', function (d) {\n    return \"newcase\";\n  }).attr(\"cx\", function (d) {\n    return x(d.Date);\n  }).attr(\"cy\", function (d) {\n    return y1(d.Weekly_New_Cases);\n  }).attr(\"r\", 5).attr(\"stroke\", \"white\").style(\"fill\", \"red\").on(\"mouseover\", showNewCaseTooltip).on(\"mousemove\", moveTooltip).on(\"mouseleave\", hideTooltip); // Add legend\n\n  g.append(\"circle\").attr(\"cx\", 850).attr(\"cy\", 25).attr(\"r\", 6).style(\"fill\", \"steelblue\");\n  g.append(\"circle\").attr(\"cx\", 850).attr(\"cy\", 45).attr(\"r\", 6).style(\"fill\", \"red\");\n  g.append(\"text\").attr(\"x\", 860).attr(\"y\", 25).text(\"Weekly ICSA\").style(\"font-size\", \"15px\").attr(\"alignment-baseline\", \"middle\").on(\"click\", function (d) {\n    d3.selectAll(\".icsa\").transition().style(\"opacity\", d3.selectAll(\".icsa\").style(\"opacity\") == 1 ? 0 : 1);\n  });\n  g.append(\"text\").attr(\"x\", 860).attr(\"y\", 45).text(\"Weekly new case\").style(\"font-size\", \"15px\").attr(\"alignment-baseline\", \"middle\").on(\"click\", function (d) {\n    d3.selectAll(\".newcase\").transition().style(\"opacity\", d3.selectAll(\".newcase\").style(\"opacity\") == 1 ? 0 : 1);\n  }); // Add transition\n  // var curtain = g.append('rect')\n  //     .attr('x', -1 * width)\n  //     .attr('y', -1 * height)\n  //     .attr('height', height)\n  //     .attr('width', width + 1)\n  //     .attr('class', 'curtain')\n  //     .attr('transform', 'rotate(180)')\n  //     .style('fill', '#eee')\n  // var t = g.transition()\n  //     .delay(750)\n  //     .duration(6000)\n  //     .ease(d3.easeLinear);\n  // t.select('rect.curtain')\n  //     .attr('width', 0);\n\n  var totalLength0 = path0.node().getTotalLength();\n  var totalLength1 = path1.node().getTotalLength();\n  path0.attr(\"stroke-dasharray\", totalLength0 + \" \" + totalLength0).attr(\"stroke-dashoffset\", totalLength0).transition().duration(2000).ease(d3.easeLinear).attr(\"stroke-dashoffset\", 0);\n  path1.attr(\"stroke-dasharray\", totalLength1 + \" \" + totalLength1).attr(\"stroke-dashoffset\", totalLength1).transition().duration(2000).ease(d3.easeLinear).attr(\"stroke-dashoffset\", 0);\n  path0.transition().duration(2000).ease(d3.easeLinear).attr(\"stroke-dashoffset\", totalLength0);\n  path1.transition().duration(2000).ease(d3.easeLinear).attr(\"stroke-dashoffset\", totalLength1); // Add title\n\n  g.append('text').attr('class', 'chart-title').attr('x', width / 2).attr('y', 0).attr('text-anchor', 'middle').style('font-size', '16px').text(title);\n};\n\nchart.cleanUp = function (el) {\n  d3.selectAll('.x-axis').remove();\n  d3.selectAll('.y-axis').remove();\n  d3.selectAll('.chart-title').remove();\n  d3.selectAll('.icsa').remove();\n  d3.selectAll('.newcase').remove();\n};\n\nexport default chart;","map":{"version":3,"sources":["/Users/rubychan/covidapp/src/chartD3.js"],"names":["d3","parseTime","timeParse","chart","x","y0","y1","line0","line1","width","height","g","create","el","props","state","margin","top","right","bottom","left","svg","select","append","attr","scaleTime","rangeRound","scaleLinear","line","d","Date","y","Weekly_ICSA","Weekly_New_Cases","update","draw","data","title","cleanUp","forEach","domain","extent","max","call","axisBottom","ticks","timeWeek","every","style","axisLeft","axisRight","path0","datum","path1","tooltip","showICSATooltip","transition","duration","html","event","pageX","pageY","showNewCaseTooltip","moveTooltip","hideTooltip","selectAll","enter","on","text","totalLength0","node","getTotalLength","totalLength1","ease","easeLinear","remove"],"mappings":"AACA,OAAO,KAAKA,EAAZ,MAAoB,IAApB;AAEA,MAAMC,SAAS,GAAGD,EAAE,CAACE,SAAH,CAAa,UAAb,CAAlB;AAEA,IAAIC,KAAK,GAAG,EAAZ;AAAA,IACIC,CADJ;AAAA,IACOC,EADP;AAAA,IACWC,EADX;AAAA,IAEIC,KAFJ;AAAA,IAEWC,KAFX;AAAA,IAGIC,KAHJ;AAAA,IAIIC,MAJJ;AAAA,IAKIC,CALJ;;AAOAR,KAAK,CAACS,MAAN,GAAe,CAACC,EAAD,EAAKC,KAAL,EAAYC,KAAZ,KAAsB;AACjC,QAAMC,MAAM,GAAG;AAAEC,IAAAA,GAAG,EAAE,EAAP;AAAWC,IAAAA,KAAK,EAAE,EAAlB;AAAsBC,IAAAA,MAAM,EAAE,EAA9B;AAAkCC,IAAAA,IAAI,EAAE;AAAxC,GAAf;AAEA,MAAIC,GAAG,GAAGrB,EAAE,CAACsB,MAAH,CAAUT,EAAV,EAAcU,MAAd,CAAqB,KAArB,EACLC,IADK,CACA,OADA,EACS,OADT,EAELA,IAFK,CAEA,OAFA,EAESV,KAAK,CAACL,KAFf,EAGLe,IAHK,CAGA,QAHA,EAGUV,KAAK,CAACJ,MAHhB,CAAV;AAKAD,EAAAA,KAAK,GAAGY,GAAG,CAACG,IAAJ,CAAS,OAAT,IAAoBR,MAAM,CAACI,IAA3B,GAAkCJ,MAAM,CAACE,KAAjD;AACAR,EAAAA,MAAM,GAAGW,GAAG,CAACG,IAAJ,CAAS,QAAT,IAAqBR,MAAM,CAACC,GAA5B,GAAkCD,MAAM,CAACG,MAAlD;AAEAR,EAAAA,CAAC,GAAGU,GAAG,CAACE,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,WAArB,EAAkC,eAAeR,MAAM,CAACI,IAAtB,GAA6B,GAA7B,GAAmCJ,MAAM,CAACC,GAA1C,GAAgD,GAAlF,CAAJ;AACAb,EAAAA,CAAC,GAAGJ,EAAE,CAACyB,SAAH,GAAeC,UAAf,CAA0B,CAAC,CAAD,EAAIjB,KAAJ,CAA1B,CAAJ;AACAJ,EAAAA,EAAE,GAAGL,EAAE,CAAC2B,WAAH,GAAiBD,UAAjB,CAA4B,CAAChB,MAAD,EAAS,CAAT,CAA5B,CAAL;AACAJ,EAAAA,EAAE,GAAGN,EAAE,CAAC2B,WAAH,GAAiBD,UAAjB,CAA4B,CAAChB,MAAD,EAAS,CAAT,CAA5B,CAAL;AAEAH,EAAAA,KAAK,GAAGP,EAAE,CAAC4B,IAAH,GACHxB,CADG,CACD,UAAUyB,CAAV,EAAa;AAAE,WAAOzB,CAAC,CAACyB,CAAC,CAACC,IAAH,CAAR;AAAmB,GADjC,EAEHC,CAFG,CAED,UAAUF,CAAV,EAAa;AAAE,WAAOxB,EAAE,CAACwB,CAAC,CAACG,WAAH,CAAT;AAA2B,GAFzC,CAAR;AAIAxB,EAAAA,KAAK,GAAGR,EAAE,CAAC4B,IAAH,GACHxB,CADG,CACD,UAAUyB,CAAV,EAAa;AAAE,WAAOzB,CAAC,CAACyB,CAAC,CAACC,IAAH,CAAR;AAAmB,GADjC,EAEHC,CAFG,CAED,UAAUF,CAAV,EAAa;AAAE,WAAOvB,EAAE,CAACuB,CAAC,CAACI,gBAAH,CAAT;AAAgC,GAF9C,CAAR;AAKA9B,EAAAA,KAAK,CAAC+B,MAAN,CAAanB,KAAb;AACH,CA1BD;;AA4BAZ,KAAK,CAAC+B,MAAN,GAAgBnB,KAAD,IAAW;AACtB,MAAIM,GAAG,GAAGrB,EAAE,CAACsB,MAAH,CAAU,KAAV,CAAV;AAEAnB,EAAAA,KAAK,CAACgC,IAAN,CAAWd,GAAX,EAAgBN,KAAK,CAACqB,IAAtB,EAA4BrB,KAAK,CAACsB,KAAlC;AACH,CAJD;;AAMAlC,KAAK,CAACgC,IAAN,GAAa,UAAUd,GAAV,EAAee,IAAf,EAAqBC,KAArB,EAA4B;AACrC,OAAKC,OAAL;AAEAF,EAAAA,IAAI,CAACG,OAAL,CAAa,UAAUV,CAAV,EAAa;AACtBA,IAAAA,CAAC,CAACC,IAAF,GAAS7B,SAAS,CAAC4B,CAAC,CAACC,IAAH,CAAlB;AACAD,IAAAA,CAAC,CAACG,WAAF,GAAgB,CAACH,CAAC,CAACG,WAAnB;AACAH,IAAAA,CAAC,CAACI,gBAAF,GAAqB,CAACJ,CAAC,CAACI,gBAAxB;AACA,WAAOJ,CAAP;AACH,GALD;AAOAzB,EAAAA,CAAC,CAACoC,MAAF,CAASxC,EAAE,CAACyC,MAAH,CAAUL,IAAV,EAAgB,UAAUP,CAAV,EAAa;AAAE,WAAOA,CAAC,CAACC,IAAT;AAAgB,GAA/C,CAAT;AACAzB,EAAAA,EAAE,CAACmC,MAAH,CAAU,CAAC,CAAD,EAAIxC,EAAE,CAAC0C,GAAH,CAAON,IAAP,EAAa,UAAUP,CAAV,EAAa;AAAE,WAAOA,CAAC,CAACG,WAAT;AAAuB,GAAnD,CAAJ,CAAV;AACA1B,EAAAA,EAAE,CAACkC,MAAH,CAAU,CAAC,CAAD,EAAIxC,EAAE,CAAC0C,GAAH,CAAON,IAAP,EAAa,UAAUP,CAAV,EAAa;AAAE,WAAOA,CAAC,CAACI,gBAAT;AAA4B,GAAxD,CAAJ,CAAV,EAZqC,CAcrC;;AACAtB,EAAAA,CAAC,CAACY,MAAF,CAAS,GAAT,EACKC,IADL,CACU,OADV,EACmB,QADnB,EAEKA,IAFL,CAEU,WAFV,EAEuB,iBAAiBd,MAAjB,GAA0B,GAFjD,EAGKiC,IAHL,CAGU3C,EAAE,CAAC4C,UAAH,CAAcxC,CAAd,EAAiByC,KAAjB,CAAuB7C,EAAE,CAAC8C,QAAH,CAAYC,KAAZ,CAAkB,CAAlB,CAAvB,CAHV;AAKApC,EAAAA,CAAC,CAACY,MAAF,CAAS,GAAT,EACKC,IADL,CACU,OADV,EACmB,QADnB,EAEKwB,KAFL,CAEW,MAFX,EAEmB,WAFnB,EAGKxB,IAHL,CAGU,MAHV,EAGkB,WAHlB,EAIKmB,IAJL,CAIU3C,EAAE,CAACiD,QAAH,CAAY5C,EAAZ,CAJV,EApBqC,CAyBrC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEAM,EAAAA,CAAC,CAACY,MAAF,CAAS,GAAT,EACKC,IADL,CACU,OADV,EACmB,QADnB,EAEKwB,KAFL,CAEW,MAFX,EAEmB,KAFnB,EAGKxB,IAHL,CAGU,WAHV,EAGuB,eAAef,KAAf,GAAuB,MAH9C,EAIKe,IAJL,CAIU,MAJV,EAIkB,KAJlB,EAKKmB,IALL,CAKU3C,EAAE,CAACkD,SAAH,CAAa5C,EAAb,CALV,EAjCqC,CAuCrC;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;;AACA,MAAI6C,KAAK,GAAGxC,CAAC,CAACY,MAAF,CAAS,MAAT,EACPC,IADO,CACF,OADE,EACO,UAAUK,CAAV,EAAa;AAAE,WAAO,MAAP;AAAgB,GADtC,EAEPuB,KAFO,CAEDhB,IAFC,EAGPZ,IAHO,CAGF,MAHE,EAGM,MAHN,EAIPA,IAJO,CAIF,QAJE,EAIQ,WAJR,EAKPA,IALO,CAKF,iBALE,EAKiB,OALjB,EAMPA,IANO,CAMF,gBANE,EAMgB,OANhB,EAOPA,IAPO,CAOF,cAPE,EAOc,GAPd,EAQPA,IARO,CAQF,GARE,EAQGjB,KARH,CAAZ;AAUA,MAAI8C,KAAK,GAAG1C,CAAC,CAACY,MAAF,CAAS,MAAT,EACPC,IADO,CACF,OADE,EACO,UAAUK,CAAV,EAAa;AAAE,WAAO,SAAP;AAAmB,GADzC,EAEPuB,KAFO,CAEDhB,IAFC,EAGPZ,IAHO,CAGF,MAHE,EAGM,MAHN,EAIPA,IAJO,CAIF,QAJE,EAIQ,KAJR,EAKPA,IALO,CAKF,iBALE,EAKiB,OALjB,EAMPA,IANO,CAMF,gBANE,EAMgB,OANhB,EAOPA,IAPO,CAOF,cAPE,EAOc,GAPd,EAQPA,IARO,CAQF,GARE,EAQGhB,KARH,CAAZ,CA1DqC,CAoErC;;AACA,MAAI8C,OAAO,GAAGtD,EAAE,CAACsB,MAAH,CAAU,MAAV,EACTC,MADS,CACF,KADE,EAETyB,KAFS,CAEH,SAFG,EAEQ,CAFR,EAGTxB,IAHS,CAGJ,OAHI,EAGK,SAHL,EAITwB,KAJS,CAIH,kBAJG,EAIiB,MAJjB,EAKTA,KALS,CAKH,eALG,EAKc,KALd,EAMTA,KANS,CAMH,SANG,EAMQ,MANR,EAOTA,KAPS,CAOH,OAPG,EAOM,OAPN,CAAd;;AASA,MAAIO,eAAe,GAAG,UAAU1B,CAAV,EAAa;AAC/ByB,IAAAA,OAAO,CACFE,UADL,GAEKC,QAFL,CAEc,GAFd;AAGAH,IAAAA,OAAO,CACFN,KADL,CACW,SADX,EACsB,CADtB,EAEKU,IAFL,CAEU,kBAAkB7B,CAAC,CAACG,WAF9B,EAGKgB,KAHL,CAGW,MAHX,EAGoBhD,EAAE,CAAC2D,KAAH,CAASC,KAAV,GAAmB,IAHtC,EAIKZ,KAJL,CAIW,KAJX,EAImBhD,EAAE,CAAC2D,KAAH,CAASE,KAAT,GAAiB,EAAlB,GAAwB,IAJ1C;AAKH,GATD;;AAWA,MAAIC,kBAAkB,GAAG,UAAUjC,CAAV,EAAa;AAClCyB,IAAAA,OAAO,CACFE,UADL,GAEKC,QAFL,CAEc,GAFd;AAGAH,IAAAA,OAAO,CACFN,KADL,CACW,SADX,EACsB,CADtB,EAEKU,IAFL,CAEU,uBAAuB7B,CAAC,CAACI,gBAFnC,EAGKe,KAHL,CAGW,MAHX,EAGoBhD,EAAE,CAAC2D,KAAH,CAASC,KAAV,GAAmB,IAHtC,EAIKZ,KAJL,CAIW,KAJX,EAImBhD,EAAE,CAAC2D,KAAH,CAASE,KAAT,GAAiB,EAAlB,GAAwB,IAJ1C;AAKH,GATD;;AAWA,MAAIE,WAAW,GAAG,UAAUlC,CAAV,EAAa;AAC3ByB,IAAAA,OAAO,CACFN,KADL,CACW,MADX,EACoBhD,EAAE,CAAC2D,KAAH,CAASC,KAAV,GAAmB,IADtC,EAEKZ,KAFL,CAEW,KAFX,EAEmBhD,EAAE,CAAC2D,KAAH,CAASE,KAAT,GAAiB,EAAlB,GAAwB,IAF1C;AAGH,GAJD;;AAMA,MAAIG,WAAW,GAAG,UAAUnC,CAAV,EAAa;AAC3ByB,IAAAA,OAAO,CACFE,UADL,GAEKC,QAFL,CAEc,GAFd,EAGKT,KAHL,CAGW,SAHX,EAGsB,CAHtB;AAIH,GALD,CA1GqC,CAiHrC;;;AACArC,EAAAA,CAAC,CAACsD,SAAF,CAAY,UAAZ,EACK7B,IADL,CACUA,IADV,EAEK8B,KAFL,GAGK3C,MAHL,CAGY,QAHZ,EAIKC,IAJL,CAIU,OAJV,EAImB,UAAUK,CAAV,EAAa;AAAE,WAAO,MAAP;AAAgB,GAJlD,EAKKL,IALL,CAKU,IALV,EAKgB,UAAUK,CAAV,EAAa;AAAE,WAAOzB,CAAC,CAACyB,CAAC,CAACC,IAAH,CAAR;AAAmB,GALlD,EAMKN,IANL,CAMU,IANV,EAMgB,UAAUK,CAAV,EAAa;AAAE,WAAOxB,EAAE,CAACwB,CAAC,CAACG,WAAH,CAAT;AAA2B,GAN1D,EAOKR,IAPL,CAOU,GAPV,EAOe,CAPf,EAQKA,IARL,CAQU,QARV,EAQoB,OARpB,EASKwB,KATL,CASW,MATX,EASmB,WATnB,EAUKmB,EAVL,CAUQ,WAVR,EAUqBZ,eAVrB,EAWKY,EAXL,CAWQ,WAXR,EAWqBJ,WAXrB,EAYKI,EAZL,CAYQ,YAZR,EAYsBH,WAZtB;AAcArD,EAAAA,CAAC,CAACsD,SAAF,CAAY,UAAZ,EACK7B,IADL,CACUA,IADV,EAEK8B,KAFL,GAGK3C,MAHL,CAGY,QAHZ,EAIKC,IAJL,CAIU,OAJV,EAImB,UAAUK,CAAV,EAAa;AAAE,WAAO,SAAP;AAAmB,GAJrD,EAKKL,IALL,CAKU,IALV,EAKgB,UAAUK,CAAV,EAAa;AAAE,WAAOzB,CAAC,CAACyB,CAAC,CAACC,IAAH,CAAR;AAAmB,GALlD,EAMKN,IANL,CAMU,IANV,EAMgB,UAAUK,CAAV,EAAa;AAAE,WAAOvB,EAAE,CAACuB,CAAC,CAACI,gBAAH,CAAT;AAAgC,GAN/D,EAOKT,IAPL,CAOU,GAPV,EAOe,CAPf,EAQKA,IARL,CAQU,QARV,EAQoB,OARpB,EASKwB,KATL,CASW,MATX,EASmB,KATnB,EAUKmB,EAVL,CAUQ,WAVR,EAUqBL,kBAVrB,EAWKK,EAXL,CAWQ,WAXR,EAWqBJ,WAXrB,EAYKI,EAZL,CAYQ,YAZR,EAYsBH,WAZtB,EAhIqC,CA8IrC;;AACArD,EAAAA,CAAC,CAACY,MAAF,CAAS,QAAT,EAAmBC,IAAnB,CAAwB,IAAxB,EAA8B,GAA9B,EAAmCA,IAAnC,CAAwC,IAAxC,EAA8C,EAA9C,EAAkDA,IAAlD,CAAuD,GAAvD,EAA4D,CAA5D,EAA+DwB,KAA/D,CAAqE,MAArE,EAA6E,WAA7E;AACArC,EAAAA,CAAC,CAACY,MAAF,CAAS,QAAT,EAAmBC,IAAnB,CAAwB,IAAxB,EAA8B,GAA9B,EAAmCA,IAAnC,CAAwC,IAAxC,EAA8C,EAA9C,EAAkDA,IAAlD,CAAuD,GAAvD,EAA4D,CAA5D,EAA+DwB,KAA/D,CAAqE,MAArE,EAA6E,KAA7E;AACArC,EAAAA,CAAC,CAACY,MAAF,CAAS,MAAT,EAAiBC,IAAjB,CAAsB,GAAtB,EAA2B,GAA3B,EAAgCA,IAAhC,CAAqC,GAArC,EAA0C,EAA1C,EAA8C4C,IAA9C,CAAmD,aAAnD,EAAkEpB,KAAlE,CAAwE,WAAxE,EAAqF,MAArF,EAA6FxB,IAA7F,CAAkG,oBAAlG,EAAwH,QAAxH,EAAkI2C,EAAlI,CAAqI,OAArI,EAA8I,UAAUtC,CAAV,EAAa;AACvJ7B,IAAAA,EAAE,CAACiE,SAAH,CAAa,OAAb,EAAsBT,UAAtB,GAAmCR,KAAnC,CAAyC,SAAzC,EAAoDhD,EAAE,CAACiE,SAAH,CAAa,OAAb,EAAsBjB,KAAtB,CAA4B,SAA5B,KAA0C,CAA1C,GAA8C,CAA9C,GAAkD,CAAtG;AACH,GAFD;AAGArC,EAAAA,CAAC,CAACY,MAAF,CAAS,MAAT,EAAiBC,IAAjB,CAAsB,GAAtB,EAA2B,GAA3B,EAAgCA,IAAhC,CAAqC,GAArC,EAA0C,EAA1C,EAA8C4C,IAA9C,CAAmD,iBAAnD,EAAsEpB,KAAtE,CAA4E,WAA5E,EAAyF,MAAzF,EAAiGxB,IAAjG,CAAsG,oBAAtG,EAA4H,QAA5H,EAAsI2C,EAAtI,CAAyI,OAAzI,EAAkJ,UAAUtC,CAAV,EAAa;AAC3J7B,IAAAA,EAAE,CAACiE,SAAH,CAAa,UAAb,EAAyBT,UAAzB,GAAsCR,KAAtC,CAA4C,SAA5C,EAAuDhD,EAAE,CAACiE,SAAH,CAAa,UAAb,EAAyBjB,KAAzB,CAA+B,SAA/B,KAA6C,CAA7C,GAAiD,CAAjD,GAAqD,CAA5G;AACH,GAFD,EApJqC,CAwJrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;;AAEA,MAAIqB,YAAY,GAAGlB,KAAK,CAACmB,IAAN,GAAaC,cAAb,EAAnB;AACA,MAAIC,YAAY,GAAGnB,KAAK,CAACiB,IAAN,GAAaC,cAAb,EAAnB;AAEApB,EAAAA,KAAK,CACA3B,IADL,CACU,kBADV,EAC8B6C,YAAY,GAAG,GAAf,GAAqBA,YADnD,EAEK7C,IAFL,CAEU,mBAFV,EAE+B6C,YAF/B,EAGKb,UAHL,GAIKC,QAJL,CAIc,IAJd,EAKKgB,IALL,CAKUzE,EAAE,CAAC0E,UALb,EAMKlD,IANL,CAMU,mBANV,EAM+B,CAN/B;AAQA6B,EAAAA,KAAK,CACA7B,IADL,CACU,kBADV,EAC8BgD,YAAY,GAAG,GAAf,GAAqBA,YADnD,EAEKhD,IAFL,CAEU,mBAFV,EAE+BgD,YAF/B,EAGKhB,UAHL,GAIKC,QAJL,CAIc,IAJd,EAKKgB,IALL,CAKUzE,EAAE,CAAC0E,UALb,EAMKlD,IANL,CAMU,mBANV,EAM+B,CAN/B;AAQA2B,EAAAA,KAAK,CACAK,UADL,GAEKC,QAFL,CAEc,IAFd,EAGKgB,IAHL,CAGUzE,EAAE,CAAC0E,UAHb,EAIKlD,IAJL,CAIU,mBAJV,EAI+B6C,YAJ/B;AAMAhB,EAAAA,KAAK,CACAG,UADL,GAEKC,QAFL,CAEc,IAFd,EAGKgB,IAHL,CAGUzE,EAAE,CAAC0E,UAHb,EAIKlD,IAJL,CAIU,mBAJV,EAI+BgD,YAJ/B,EAnMqC,CA2MrC;;AACA7D,EAAAA,CAAC,CAACY,MAAF,CAAS,MAAT,EACKC,IADL,CACU,OADV,EACmB,aADnB,EAEKA,IAFL,CAEU,GAFV,EAEgBf,KAAK,GAAG,CAFxB,EAGKe,IAHL,CAGU,GAHV,EAGe,CAHf,EAIKA,IAJL,CAIU,aAJV,EAIyB,QAJzB,EAKKwB,KALL,CAKW,WALX,EAKwB,MALxB,EAMKoB,IANL,CAMU/B,KANV;AAOH,CAnND;;AAqNAlC,KAAK,CAACmC,OAAN,GAAgB,UAAUzB,EAAV,EAAc;AAC1Bb,EAAAA,EAAE,CAACiE,SAAH,CAAa,SAAb,EAAwBU,MAAxB;AACA3E,EAAAA,EAAE,CAACiE,SAAH,CAAa,SAAb,EAAwBU,MAAxB;AACA3E,EAAAA,EAAE,CAACiE,SAAH,CAAa,cAAb,EAA6BU,MAA7B;AACA3E,EAAAA,EAAE,CAACiE,SAAH,CAAa,OAAb,EAAsBU,MAAtB;AACA3E,EAAAA,EAAE,CAACiE,SAAH,CAAa,UAAb,EAAyBU,MAAzB;AACH,CAND;;AAQA,eAAexE,KAAf","sourcesContent":["\nimport * as d3 from 'd3';\n\nconst parseTime = d3.timeParse('%d/%m/%y');\n\nlet chart = {},\n    x, y0, y1,\n    line0, line1,\n    width,\n    height,\n    g;\n\nchart.create = (el, props, state) => {\n    const margin = { top: 20, right: 80, bottom: 30, left: 80 };\n\n    let svg = d3.select(el).append('svg')\n        .attr('class', 'chart')\n        .attr('width', props.width)\n        .attr('height', props.height);\n\n    width = svg.attr('width') - margin.left - margin.right;\n    height = svg.attr('height') - margin.top - margin.bottom;\n\n    g = svg.append('g').attr('transform', 'translate(' + margin.left + ',' + margin.top + ')');\n    x = d3.scaleTime().rangeRound([0, width]);\n    y0 = d3.scaleLinear().rangeRound([height, 0]);\n    y1 = d3.scaleLinear().rangeRound([height, 0]);\n\n    line0 = d3.line()\n        .x(function (d) { return x(d.Date); })\n        .y(function (d) { return y0(d.Weekly_ICSA); });\n\n    line1 = d3.line()\n        .x(function (d) { return x(d.Date); })\n        .y(function (d) { return y1(d.Weekly_New_Cases); });\n\n\n    chart.update(state);\n}\n\nchart.update = (state) => {\n    let svg = d3.select('svg');\n\n    chart.draw(svg, state.data, state.title);\n}\n\nchart.draw = function (svg, data, title) {\n    this.cleanUp();\n\n    data.forEach(function (d) {\n        d.Date = parseTime(d.Date);\n        d.Weekly_ICSA = +d.Weekly_ICSA;\n        d.Weekly_New_Cases = +d.Weekly_New_Cases;\n        return d;\n    });\n\n    x.domain(d3.extent(data, function (d) { return d.Date; }));\n    y0.domain([0, d3.max(data, function (d) { return d.Weekly_ICSA; })]);\n    y1.domain([0, d3.max(data, function (d) { return d.Weekly_New_Cases; })]);\n\n    // Add axis:\n    g.append('g')\n        .attr('class', 'x-axis')\n        .attr('transform', 'translate(0,' + height + ')')\n        .call(d3.axisBottom(x).ticks(d3.timeWeek.every(2)));\n\n    g.append('g')\n        .attr('class', 'y-axis')\n        .style(\"fill\", \"steelblue\")\n        .attr('fill', 'steelblue')\n        .call(d3.axisLeft(y0));\n    // .append('text')\n    // .attr('fill', 'steelblue')\n    // .attr('transform', 'rotate(-90)')\n    // .attr('y', 6)\n    // .attr('dy', '0.71em')\n    // .attr('text-anchor', 'end')\n    // .text('Weekly ICSA');\n\n    g.append('g')\n        .attr('class', 'y-axis')\n        .style(\"fill\", \"red\")\n        .attr(\"transform\", \"translate(\" + width + \" ,0)\")\n        .attr('fill', 'red')\n        .call(d3.axisRight(y1));\n    // .append('text')\n    // .attr('fill', 'red')\n    // .attr(\"transform\", \"translate(\" + width + \" ,0)\")\n    // .attr('y', 6)\n    // .attr('dy', '0.71em')\n    // .attr('text-anchor', 'end')\n    // .text('Weekly New Case');\n\n    // Add path:\n    var path0 = g.append('path')\n        .attr('class', function (d) { return \"icsa\"; })\n        .datum(data)\n        .attr('fill', 'none')\n        .attr('stroke', 'steelblue')\n        .attr('stroke-linejoin', 'round')\n        .attr('stroke-linecap', 'round')\n        .attr('stroke-width', 1.5)\n        .attr('d', line0);\n\n    var path1 = g.append('path')\n        .attr('class', function (d) { return \"newcase\"; })\n        .datum(data)\n        .attr('fill', 'none')\n        .attr('stroke', 'red')\n        .attr('stroke-linejoin', 'round')\n        .attr('stroke-linecap', 'round')\n        .attr('stroke-width', 1.5)\n        .attr('d', line1);\n\n    // Add tooltip\n    var tooltip = d3.select(\"body\")\n        .append(\"div\")\n        .style(\"opacity\", 0)\n        .attr(\"class\", \"tooltip\")\n        .style(\"background-color\", \"grey\")\n        .style(\"border-radius\", \"5px\")\n        .style(\"padding\", \"10px\")\n        .style(\"color\", \"white\")\n\n    var showICSATooltip = function (d) {\n        tooltip\n            .transition()\n            .duration(200)\n        tooltip\n            .style(\"opacity\", 1)\n            .html(\"Weekly ICSA: \" + d.Weekly_ICSA)\n            .style(\"left\", (d3.event.pageX) + \"px\")\n            .style(\"top\", (d3.event.pageY - 28) + \"px\");\n    }\n\n    var showNewCaseTooltip = function (d) {\n        tooltip\n            .transition()\n            .duration(200)\n        tooltip\n            .style(\"opacity\", 1)\n            .html(\"Weekly New Cases: \" + d.Weekly_New_Cases)\n            .style(\"left\", (d3.event.pageX) + \"px\")\n            .style(\"top\", (d3.event.pageY - 28) + \"px\");\n    }\n\n    var moveTooltip = function (d) {\n        tooltip\n            .style(\"left\", (d3.event.pageX) + \"px\")\n            .style(\"top\", (d3.event.pageY - 28) + \"px\");\n    }\n\n    var hideTooltip = function (d) {\n        tooltip\n            .transition()\n            .duration(200)\n            .style(\"opacity\", 0)\n    }\n\n    // Add circle:\n    g.selectAll(\"myPoints\")\n        .data(data)\n        .enter()\n        .append('circle')\n        .attr('class', function (d) { return \"icsa\"; })\n        .attr(\"cx\", function (d) { return x(d.Date); })\n        .attr(\"cy\", function (d) { return y0(d.Weekly_ICSA); })\n        .attr(\"r\", 5)\n        .attr(\"stroke\", \"white\")\n        .style(\"fill\", \"steelblue\")\n        .on(\"mouseover\", showICSATooltip)\n        .on(\"mousemove\", moveTooltip)\n        .on(\"mouseleave\", hideTooltip)\n\n    g.selectAll(\"myPoints\")\n        .data(data)\n        .enter()\n        .append('circle')\n        .attr('class', function (d) { return \"newcase\"; })\n        .attr(\"cx\", function (d) { return x(d.Date); })\n        .attr(\"cy\", function (d) { return y1(d.Weekly_New_Cases); })\n        .attr(\"r\", 5)\n        .attr(\"stroke\", \"white\")\n        .style(\"fill\", \"red\")\n        .on(\"mouseover\", showNewCaseTooltip)\n        .on(\"mousemove\", moveTooltip)\n        .on(\"mouseleave\", hideTooltip)\n\n    // Add legend\n    g.append(\"circle\").attr(\"cx\", 850).attr(\"cy\", 25).attr(\"r\", 6).style(\"fill\", \"steelblue\");\n    g.append(\"circle\").attr(\"cx\", 850).attr(\"cy\", 45).attr(\"r\", 6).style(\"fill\", \"red\");\n    g.append(\"text\").attr(\"x\", 860).attr(\"y\", 25).text(\"Weekly ICSA\").style(\"font-size\", \"15px\").attr(\"alignment-baseline\", \"middle\").on(\"click\", function (d) {\n        d3.selectAll(\".icsa\").transition().style(\"opacity\", d3.selectAll(\".icsa\").style(\"opacity\") == 1 ? 0 : 1);\n    });\n    g.append(\"text\").attr(\"x\", 860).attr(\"y\", 45).text(\"Weekly new case\").style(\"font-size\", \"15px\").attr(\"alignment-baseline\", \"middle\").on(\"click\", function (d) {\n        d3.selectAll(\".newcase\").transition().style(\"opacity\", d3.selectAll(\".newcase\").style(\"opacity\") == 1 ? 0 : 1);\n    });\n\n    // Add transition\n    // var curtain = g.append('rect')\n    //     .attr('x', -1 * width)\n    //     .attr('y', -1 * height)\n    //     .attr('height', height)\n    //     .attr('width', width + 1)\n    //     .attr('class', 'curtain')\n    //     .attr('transform', 'rotate(180)')\n    //     .style('fill', '#eee')\n\n    // var t = g.transition()\n    //     .delay(750)\n    //     .duration(6000)\n    //     .ease(d3.easeLinear);\n\n    // t.select('rect.curtain')\n    //     .attr('width', 0);\n\n    var totalLength0 = path0.node().getTotalLength();\n    var totalLength1 = path1.node().getTotalLength();\n\n    path0\n        .attr(\"stroke-dasharray\", totalLength0 + \" \" + totalLength0)\n        .attr(\"stroke-dashoffset\", totalLength0)\n        .transition()\n        .duration(2000)\n        .ease(d3.easeLinear)\n        .attr(\"stroke-dashoffset\", 0);\n\n    path1\n        .attr(\"stroke-dasharray\", totalLength1 + \" \" + totalLength1)\n        .attr(\"stroke-dashoffset\", totalLength1)\n        .transition()\n        .duration(2000)\n        .ease(d3.easeLinear)\n        .attr(\"stroke-dashoffset\", 0);\n\n    path0\n        .transition()\n        .duration(2000)\n        .ease(d3.easeLinear)\n        .attr(\"stroke-dashoffset\", totalLength0);\n\n    path1\n        .transition()\n        .duration(2000)\n        .ease(d3.easeLinear)\n        .attr(\"stroke-dashoffset\", totalLength1);\n\n\n\n    // Add title\n    g.append('text')\n        .attr('class', 'chart-title')\n        .attr('x', (width / 2))\n        .attr('y', 0)\n        .attr('text-anchor', 'middle')\n        .style('font-size', '16px')\n        .text(title);\n}\n\nchart.cleanUp = function (el) {\n    d3.selectAll('.x-axis').remove();\n    d3.selectAll('.y-axis').remove();\n    d3.selectAll('.chart-title').remove();\n    d3.selectAll('.icsa').remove();\n    d3.selectAll('.newcase').remove();\n};\n\nexport default chart;"]},"metadata":{},"sourceType":"module"}