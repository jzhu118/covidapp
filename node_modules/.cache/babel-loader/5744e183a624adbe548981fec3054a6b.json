{"ast":null,"code":"import*as d3 from'd3';var parseTime=d3.timeParse('%d/%m/%y');var chart={},x,y0,y1,line0,line1,width,height,g;chart.create=function(el,props,state){var margin={top:20,right:80,bottom:30,left:80};var svg=d3.select(el).append('svg').attr('class','chart').attr('width',props.width).attr('height',props.height);width=svg.attr('width')-margin.left-margin.right;height=svg.attr('height')-margin.top-margin.bottom;g=svg.append('g').attr('transform','translate('+margin.left+','+margin.top+')');x=d3.scaleTime().rangeRound([0,width]);y0=d3.scaleLinear().rangeRound([height,0]);y1=d3.scaleLinear().rangeRound([height,0]);line0=d3.line().x(function(d){return x(d.Date);}).y(function(d){return y0(d.Weekly_ICSA);});line1=d3.line().x(function(d){return x(d.Date);}).y(function(d){return y1(d.Weekly_New_Cases);});chart.update(state);};chart.update=function(state){var svg=d3.select('svg');chart.draw(svg,state.data,state.title);};chart.draw=function(svg,data,title){this.cleanUp();data.forEach(function(d){d.Date=parseTime(d.Date);d.Weekly_ICSA=+d.Weekly_ICSA;d.Weekly_New_Cases=+d.Weekly_New_Cases;return d;});x.domain(d3.extent(data,function(d){return d.Date;}));y0.domain([0,d3.max(data,function(d){return d.Weekly_ICSA;})]);y1.domain([0,d3.max(data,function(d){return d.Weekly_New_Cases;})]);// Add axis:\ng.append('g').attr('class','x-axis').attr('transform','translate(0,'+height+')').call(d3.axisBottom(x).ticks(d3.timeWeek.every(2)));g.append('g').attr('class','y-axis').style(\"fill\",\"steelblue\").attr('fill','steelblue').call(d3.axisLeft(y0));g.append('g').attr('class','y-axis').style(\"fill\",\"red\").attr(\"transform\",\"translate(\"+width+\" ,0)\").attr('fill','red').call(d3.axisRight(y1));// Add path:\nvar path0=g.append('path').attr('class',function(d){return\"icsa\";}).datum(data).attr('fill','none').attr('stroke','steelblue').attr('stroke-linejoin','round').attr('stroke-linecap','round').attr('stroke-width',1.5).attr('d',line0);var path1=g.append('path').attr('class',function(d){return\"newcase\";}).datum(data).attr('fill','none').attr('stroke','red').attr('stroke-linejoin','round').attr('stroke-linecap','round').attr('stroke-width',1.5).attr('d',line1);// Add tooltip\nvar tooltip=d3.select(\"body\").append(\"div\").style(\"opacity\",0).attr(\"class\",\"tooltip\").style(\"background-color\",\"grey\").style(\"border-radius\",\"5px\").style(\"padding\",\"10px\").style(\"color\",\"white\");var showICSATooltip=function showICSATooltip(d){tooltip.transition().duration(200);tooltip.style(\"opacity\",1).html(\"Weekly ICSA: \"+d.Weekly_ICSA).style(\"left\",d3.event.pageX+\"px\").style(\"top\",d3.event.pageY-28+\"px\");};var showNewCaseTooltip=function showNewCaseTooltip(d){tooltip.transition().duration(200);tooltip.style(\"opacity\",1).html(\"Weekly New Cases: \"+d.Weekly_New_Cases).style(\"left\",d3.event.pageX+\"px\").style(\"top\",d3.event.pageY-28+\"px\");};var moveTooltip=function moveTooltip(d){tooltip.style(\"left\",d3.event.pageX+\"px\").style(\"top\",d3.event.pageY-28+\"px\");};var hideTooltip=function hideTooltip(d){tooltip.transition().duration(200).style(\"opacity\",0);};// Add circle:\ng.selectAll(\"myPoints\").data(data).enter().append('circle').attr('class',function(d){return\"icsa\";}).attr(\"cx\",function(d){return x(d.Date);}).attr(\"cy\",function(d){return y0(d.Weekly_ICSA);}).attr(\"r\",5).attr(\"stroke\",\"white\").style(\"fill\",\"steelblue\").on(\"mouseover\",showICSATooltip).on(\"mousemove\",moveTooltip).on(\"mouseleave\",hideTooltip);g.selectAll(\"myPoints\").data(data).enter().append('circle').attr('class',function(d){return\"newcase\";}).attr(\"cx\",function(d){return x(d.Date);}).attr(\"cy\",function(d){return y1(d.Weekly_New_Cases);}).attr(\"r\",5).attr(\"stroke\",\"white\").style(\"fill\",\"red\").on(\"mouseover\",showNewCaseTooltip).on(\"mousemove\",moveTooltip).on(\"mouseleave\",hideTooltip);// Add legend\ng.append(\"circle\").attr(\"cx\",720).attr(\"cy\",45).attr(\"r\",6).style(\"fill\",\"red\");g.append(\"circle\").attr(\"cx\",720).attr(\"cy\",25).attr(\"r\",6).style(\"fill\",\"steelblue\");g.append(\"text\").attr(\"x\",730).attr(\"y\",45).text(\"Click to Show/Unshow Weekly new case\").attr(\"font-size\",\"14px\").style(\"font-size\",\"15px\").attr(\"alignment-baseline\",\"middle\").on(\"click\",function(d){d3.selectAll(\".newcase\").transition().style(\"opacity\",d3.selectAll(\".newcase\").style(\"opacity\")==1?0:1);});g.append(\"text\").attr(\"x\",730).attr(\"y\",25).text(\"Click to Show/Unshow Weekly ICSA\").attr(\"font-size\",\"14px\").style(\"font-size\",\"15px\").attr(\"alignment-baseline\",\"middle\").on(\"click\",function(d){d3.selectAll(\".icsa\").transition().style(\"opacity\",d3.selectAll(\".icsa\").style(\"opacity\")==1?0:1);});// Add transition\nif(title.trim()==\"Whole Picture: Weekly ICSA and New Cases of US from 01/25/2020 to 07/18/2020 in D3\".trim()||title.trim()==\"First Phase: Weekly ICSA and New Cases of US from 01/25/2020 to 03/21/2020 in D3\"){var totalLength0=path0.node().getTotalLength();var totalLength1=path1.node().getTotalLength();d3.selectAll('.icsa').attr(\"stroke-dasharray\",totalLength0+\" \"+totalLength0).attr(\"stroke-dashoffset\",totalLength0).transition().duration(4000).delay(1000).ease(d3.easeLinear).attr(\"stroke-dashoffset\",0);d3.selectAll('.newcase').attr(\"stroke-dasharray\",totalLength0+\" \"+totalLength1).attr(\"stroke-dashoffset\",totalLength0).transition().duration(4000).delay(1000).ease(d3.easeLinear).attr(\"stroke-dashoffset\",0);d3.selectAll(\"circle\").style(\"opacity\",0).transition().duration(5000).delay(3000).style(\"opacity\",1);}if(title.trim()==\"Second Phase: Weekly ICSA and New Cases of US from 03/28/2020 to 06/13/2020 in D3\".trim()){var totalLength0=path0.node().getTotalLength();var totalLength1=path1.node().getTotalLength();d3.selectAll('.icsa').attr(\"stroke-dasharray\",totalLength0+\" \"+totalLength0).attr(\"stroke-dashoffset\",totalLength0/2+2).transition().duration(4000).delay(1000).ease(d3.easeLinear).attr(\"stroke-dashoffset\",0);d3.selectAll('.newcase').attr(\"stroke-dasharray\",totalLength0+\" \"+totalLength1).attr(\"stroke-dashoffset\",totalLength0/2+2).transition().duration(4000).delay(1000).ease(d3.easeLinear).attr(\"stroke-dashoffset\",0);d3.selectAll(\"circle\").style(\"opacity\",0).transition().duration(5000).delay(3000).style(\"opacity\",1);}if(title.trim()==\"Third Phase: Weekly ICSA and New Cases of US from 06/20/2020 to 07/18/2020 in D3\".trim()){var totalLength0=path0.node().getTotalLength();var totalLength1=path1.node().getTotalLength();d3.selectAll('.icsa').attr(\"stroke-dasharray\",totalLength0+\" \"+totalLength0).attr(\"stroke-dashoffset\",totalLength0*0.33).transition().duration(4000).delay(1000).ease(d3.easeLinear).attr(\"stroke-dashoffset\",0);d3.selectAll('.newcase').attr(\"stroke-dasharray\",totalLength0+\" \"+totalLength1).attr(\"stroke-dashoffset\",totalLength0*0.3).transition().duration(4000).delay(1000).ease(d3.easeLinear).attr(\"stroke-dashoffset\",0);d3.selectAll(\"circle\").style(\"opacity\",0).transition().duration(5000).delay(3000).style(\"opacity\",1);}// Add title\ng.append('text').attr('class','chart-title').attr('x',width/2).attr('y',0).attr('text-anchor','middle').style('font-size','16px').text(title);};chart.cleanUp=function(el){d3.selectAll('.x-axis').remove();d3.selectAll('.y-axis').remove();d3.selectAll('.chart-title').remove();d3.selectAll('.icsa').remove();d3.selectAll('.newcase').remove();};export default chart;","map":{"version":3,"sources":["/Users/rubychan/covidapp/src/chartD3.js"],"names":["d3","parseTime","timeParse","chart","x","y0","y1","line0","line1","width","height","g","create","el","props","state","margin","top","right","bottom","left","svg","select","append","attr","scaleTime","rangeRound","scaleLinear","line","d","Date","y","Weekly_ICSA","Weekly_New_Cases","update","draw","data","title","cleanUp","forEach","domain","extent","max","call","axisBottom","ticks","timeWeek","every","style","axisLeft","axisRight","path0","datum","path1","tooltip","showICSATooltip","transition","duration","html","event","pageX","pageY","showNewCaseTooltip","moveTooltip","hideTooltip","selectAll","enter","on","text","trim","totalLength0","node","getTotalLength","totalLength1","delay","ease","easeLinear","remove"],"mappings":"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","sourcesContent":["\nimport * as d3 from 'd3';\n\nconst parseTime = d3.timeParse('%d/%m/%y');\n\nlet chart = {},\n    x, y0, y1,\n    line0, line1,\n    width,\n    height,\n    g;\n\nchart.create = (el, props, state) => {\n    const margin = { top: 20, right: 80, bottom: 30, left: 80 };\n\n    let svg = d3.select(el).append('svg')\n        .attr('class', 'chart')\n        .attr('width', props.width)\n        .attr('height', props.height);\n\n    width = svg.attr('width') - margin.left - margin.right;\n    height = svg.attr('height') - margin.top - margin.bottom;\n\n    g = svg.append('g').attr('transform', 'translate(' + margin.left + ',' + margin.top + ')');\n    x = d3.scaleTime().rangeRound([0, width]);\n    y0 = d3.scaleLinear().rangeRound([height, 0]);\n    y1 = d3.scaleLinear().rangeRound([height, 0]);\n\n    line0 = d3.line()\n        .x(function (d) { return x(d.Date); })\n        .y(function (d) { return y0(d.Weekly_ICSA); });\n\n    line1 = d3.line()\n        .x(function (d) { return x(d.Date); })\n        .y(function (d) { return y1(d.Weekly_New_Cases); });\n\n\n    chart.update(state);\n}\n\nchart.update = (state) => {\n    let svg = d3.select('svg');\n\n    chart.draw(svg, state.data, state.title);\n}\n\nchart.draw = function (svg, data, title) {\n    this.cleanUp();\n\n    data.forEach(function (d) {\n        d.Date = parseTime(d.Date);\n        d.Weekly_ICSA = +d.Weekly_ICSA;\n        d.Weekly_New_Cases = +d.Weekly_New_Cases;\n        return d;\n    });\n\n    x.domain(d3.extent(data, function (d) { return d.Date; }));\n    y0.domain([0, d3.max(data, function (d) { return d.Weekly_ICSA; })]);\n    y1.domain([0, d3.max(data, function (d) { return d.Weekly_New_Cases; })]);\n\n    // Add axis:\n    g.append('g')\n        .attr('class', 'x-axis')\n        .attr('transform', 'translate(0,' + height + ')')\n        .call(d3.axisBottom(x).ticks(d3.timeWeek.every(2)));\n\n    g.append('g')\n        .attr('class', 'y-axis')\n        .style(\"fill\", \"steelblue\")\n        .attr('fill', 'steelblue')\n        .call(d3.axisLeft(y0));\n\n    g.append('g')\n        .attr('class', 'y-axis')\n        .style(\"fill\", \"red\")\n        .attr(\"transform\", \"translate(\" + width + \" ,0)\")\n        .attr('fill', 'red')\n        .call(d3.axisRight(y1));\n\n    // Add path:\n    var path0 = g.append('path')\n        .attr('class', function (d) { return \"icsa\"; })\n        .datum(data)\n        .attr('fill', 'none')\n        .attr('stroke', 'steelblue')\n        .attr('stroke-linejoin', 'round')\n        .attr('stroke-linecap', 'round')\n        .attr('stroke-width', 1.5)\n        .attr('d', line0);\n\n    var path1 = g.append('path')\n        .attr('class', function (d) { return \"newcase\"; })\n        .datum(data)\n        .attr('fill', 'none')\n        .attr('stroke', 'red')\n        .attr('stroke-linejoin', 'round')\n        .attr('stroke-linecap', 'round')\n        .attr('stroke-width', 1.5)\n        .attr('d', line1);\n\n    // Add tooltip\n    var tooltip = d3.select(\"body\")\n        .append(\"div\")\n        .style(\"opacity\", 0)\n        .attr(\"class\", \"tooltip\")\n        .style(\"background-color\", \"grey\")\n        .style(\"border-radius\", \"5px\")\n        .style(\"padding\", \"10px\")\n        .style(\"color\", \"white\")\n\n    var showICSATooltip = function (d) {\n        tooltip\n            .transition()\n            .duration(200)\n        tooltip\n            .style(\"opacity\", 1)\n            .html(\"Weekly ICSA: \" + d.Weekly_ICSA)\n            .style(\"left\", (d3.event.pageX) + \"px\")\n            .style(\"top\", (d3.event.pageY - 28) + \"px\");\n    }\n\n    var showNewCaseTooltip = function (d) {\n        tooltip\n            .transition()\n            .duration(200)\n        tooltip\n            .style(\"opacity\", 1)\n            .html(\"Weekly New Cases: \" + d.Weekly_New_Cases)\n            .style(\"left\", (d3.event.pageX) + \"px\")\n            .style(\"top\", (d3.event.pageY - 28) + \"px\");\n    }\n\n    var moveTooltip = function (d) {\n        tooltip\n            .style(\"left\", (d3.event.pageX) + \"px\")\n            .style(\"top\", (d3.event.pageY - 28) + \"px\");\n    }\n\n    var hideTooltip = function (d) {\n        tooltip\n            .transition()\n            .duration(200)\n            .style(\"opacity\", 0)\n    }\n\n    // Add circle:\n    g.selectAll(\"myPoints\")\n        .data(data)\n        .enter()\n        .append('circle')\n        .attr('class', function (d) { return \"icsa\"; })\n        .attr(\"cx\", function (d) { return x(d.Date); })\n        .attr(\"cy\", function (d) { return y0(d.Weekly_ICSA); })\n        .attr(\"r\", 5)\n        .attr(\"stroke\", \"white\")\n        .style(\"fill\", \"steelblue\")\n        .on(\"mouseover\", showICSATooltip)\n        .on(\"mousemove\", moveTooltip)\n        .on(\"mouseleave\", hideTooltip)\n\n    g.selectAll(\"myPoints\")\n        .data(data)\n        .enter()\n        .append('circle')\n        .attr('class', function (d) { return \"newcase\"; })\n        .attr(\"cx\", function (d) { return x(d.Date); })\n        .attr(\"cy\", function (d) { return y1(d.Weekly_New_Cases); })\n        .attr(\"r\", 5)\n        .attr(\"stroke\", \"white\")\n        .style(\"fill\", \"red\")\n        .on(\"mouseover\", showNewCaseTooltip)\n        .on(\"mousemove\", moveTooltip)\n        .on(\"mouseleave\", hideTooltip)\n\n    // Add legend\n    g.append(\"circle\").attr(\"cx\", 720).attr(\"cy\", 45).attr(\"r\", 6).style(\"fill\", \"red\");\n    g.append(\"circle\").attr(\"cx\", 720).attr(\"cy\", 25).attr(\"r\", 6).style(\"fill\", \"steelblue\");\n    g.append(\"text\").attr(\"x\", 730).attr(\"y\", 45).text(\"Click to Show/Unshow Weekly new case\").attr(\"font-size\", \"14px\").style(\"font-size\", \"15px\").attr(\"alignment-baseline\", \"middle\").on(\"click\", function (d) {\n        d3.selectAll(\".newcase\").transition().style(\"opacity\", d3.selectAll(\".newcase\").style(\"opacity\") == 1 ? 0 : 1);\n    });\n    g.append(\"text\").attr(\"x\", 730).attr(\"y\", 25).text(\"Click to Show/Unshow Weekly ICSA\").attr(\"font-size\", \"14px\").style(\"font-size\", \"15px\").attr(\"alignment-baseline\", \"middle\").on(\"click\", function (d) {\n        d3.selectAll(\".icsa\").transition().style(\"opacity\", d3.selectAll(\".icsa\").style(\"opacity\") == 1 ? 0 : 1);\n    });\n\n    // Add transition\n    if (title.trim() == \"Whole Picture: Weekly ICSA and New Cases of US from 01/25/2020 to 07/18/2020 in D3\".trim() || title.trim() == \"First Phase: Weekly ICSA and New Cases of US from 01/25/2020 to 03/21/2020 in D3\") {\n        var totalLength0 = path0.node().getTotalLength();\n        var totalLength1 = path1.node().getTotalLength();\n\n        d3.selectAll('.icsa')\n            .attr(\"stroke-dasharray\", totalLength0 + \" \" + totalLength0)\n            .attr(\"stroke-dashoffset\", totalLength0)\n            .transition()\n            .duration(4000)\n            .delay(1000)\n            .ease(d3.easeLinear)\n            .attr(\"stroke-dashoffset\", 0);\n\n        d3.selectAll('.newcase')\n            .attr(\"stroke-dasharray\", totalLength0 + \" \" + totalLength1)\n            .attr(\"stroke-dashoffset\", totalLength0)\n            .transition()\n            .duration(4000)\n            .delay(1000)\n            .ease(d3.easeLinear)\n            .attr(\"stroke-dashoffset\", 0);\n\n        d3.selectAll(\"circle\").style(\"opacity\", 0).transition().duration(5000).delay(3000).style(\"opacity\", 1);\n    }\n\n    if (title.trim() == \"Second Phase: Weekly ICSA and New Cases of US from 03/28/2020 to 06/13/2020 in D3\".trim()) {\n        var totalLength0 = path0.node().getTotalLength();\n        var totalLength1 = path1.node().getTotalLength();\n\n        d3.selectAll('.icsa')\n            .attr(\"stroke-dasharray\", totalLength0 + \" \" + totalLength0)\n            .attr(\"stroke-dashoffset\", totalLength0 / 2 + 2)\n            .transition()\n            .duration(4000)\n            .delay(1000)\n            .ease(d3.easeLinear)\n            .attr(\"stroke-dashoffset\", 0);\n\n        d3.selectAll('.newcase')\n            .attr(\"stroke-dasharray\", totalLength0 + \" \" + totalLength1)\n            .attr(\"stroke-dashoffset\", totalLength0 / 2 + 2)\n            .transition()\n            .duration(4000)\n            .delay(1000)\n            .ease(d3.easeLinear)\n            .attr(\"stroke-dashoffset\", 0);\n\n        d3.selectAll(\"circle\").style(\"opacity\", 0).transition().duration(5000).delay(3000).style(\"opacity\", 1);\n    }\n\n    if (title.trim() == \"Third Phase: Weekly ICSA and New Cases of US from 06/20/2020 to 07/18/2020 in D3\".trim()) {\n        var totalLength0 = path0.node().getTotalLength();\n        var totalLength1 = path1.node().getTotalLength();\n\n        d3.selectAll('.icsa')\n            .attr(\"stroke-dasharray\", totalLength0 + \" \" + totalLength0)\n            .attr(\"stroke-dashoffset\", totalLength0 * 0.33)\n            .transition()\n            .duration(4000)\n            .delay(1000)\n            .ease(d3.easeLinear)\n            .attr(\"stroke-dashoffset\", 0);\n\n        d3.selectAll('.newcase')\n            .attr(\"stroke-dasharray\", totalLength0 + \" \" + totalLength1)\n            .attr(\"stroke-dashoffset\", totalLength0 * 0.3)\n            .transition()\n            .duration(4000)\n            .delay(1000)\n            .ease(d3.easeLinear)\n            .attr(\"stroke-dashoffset\", 0);\n\n        d3.selectAll(\"circle\").style(\"opacity\", 0).transition().duration(5000).delay(3000).style(\"opacity\", 1);\n    }\n    // Add title\n    g.append('text')\n        .attr('class', 'chart-title')\n        .attr('x', (width / 2))\n        .attr('y', 0)\n        .attr('text-anchor', 'middle')\n        .style('font-size', '16px')\n        .text(title);\n}\n\nchart.cleanUp = function (el) {\n    d3.selectAll('.x-axis').remove();\n    d3.selectAll('.y-axis').remove();\n    d3.selectAll('.chart-title').remove();\n    d3.selectAll('.icsa').remove();\n    d3.selectAll('.newcase').remove();\n};\n\nexport default chart;"]},"metadata":{},"sourceType":"module"}